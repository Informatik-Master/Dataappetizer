<nb-stepper
  orientation="horizontal"
  [disableStepNavigation]="true"
  [selectedIndex]="selectedIndex"
>
  <nb-step label="Systemname">
    <nb-card>
      <nb-card-header>
        <h2>Wählen Sie einen Namen für das Kundensystem</h2>
        <span class="caption-2"
          >Der Name diehnt zur einfacheren Identifikation des erstellten
          Systems</span
        > </nb-card-header
      ><!--TODO: Validation-->
      <nb-card-body>
        <nb-layout class="transparent fullheight">
          <nb-layout-column
            style="display: flex; justify-content: center; align-items: center"
          >
            <div
              style="
                gap: 30px;
                display: flex;
                flex-direction: column;
                width: 50%;
              "
            >
              <div>
                <label for="systemname">Systemname</label>
                <nb-form-field>
                  <input
                    id="systemname"
                    nbInput
                    fullWidth
                    placeholder="Systemname"
                    [(ngModel)]="systemName"
                  />
                </nb-form-field>
              </div>
              <div>
                <label for="subscriptionId">Subscription ID</label>
                <nb-form-field>
                  <input
                    id="subscriptionId"
                    nbInput
                    fullWidth
                    placeholder="Subscription ID"
                    [(ngModel)]="subscriptionId"
                  />
                </nb-form-field>
              </div>
            </div>
          </nb-layout-column>
        </nb-layout>
      </nb-card-body>
      <nb-card-footer style="display: flex; justify-content: end; gap: 15px">
        <button nbButton status="primary" (click)="next()" [disabled]="subscriptionId === '' || systemName===''">Weiter</button>
      </nb-card-footer>
    </nb-card>
  </nb-step>
  <!-- <nb-step label="Zugänge">
    <nb-card>
      <nb-card-header>
        <h2>Erstellen Sie die Zugänge für das Kundensystem</h2>
        <span class="caption-2"
          >Zugänge bestimmen, wer mit dem System interagieren darf</span
        >
      </nb-card-header>
      <nb-card-body>
        <nb-layout class="transparent fullheight">
          <nb-layout-column
            style="display: flex; justify-content: center; align-items: center"
          >
            <div
              style="
                gap: 30px;
                display: flex;
                flex-direction: column;
                width: 50%;
              "
            >
              TODO:
            </div>
          </nb-layout-column>
        </nb-layout>
      </nb-card-body>
      <nb-card-footer style="display: flex; justify-content: end; gap: 15px">
        <button nbButton status="secondary" (click)="previous()">Zurück</button>
        <button nbButton status="primary" (click)="next()">Weiter</button>
      </nb-card-footer>
    </nb-card>
  </nb-step> -->
  <nb-step label="Datenvisualisierung">
    <nb-card>
      <nb-card-header>
        <h2>Wählen Sie die Datenvisualisierungen für das Kundensystem</h2>
        <span class="caption-2"
          >Datenvisualisierungen bestimmen, welche die Fahrzeugdaten im System
          angezeigt werden. Bei den dargestellten Daten handelt es sich hierbei nicht um Ihre tatsächlichen Fahrzeugdaten. Diese zeigen beispielhaft an, wie die Daten visualisiert werden.</span
        >
      </nb-card-header>
      <nb-card-body style="padding: 0">
        <nb-layout class="transparent fullheight">
          <nb-layout-column>
            <nb-tabset>
              <nb-tab tabTitle="Allgemeiner Überblick">
                <nb-list>
                  <nb-list-item
                    *ngFor="let dashboardConfig of configs"
                    style="gap: 5px"
                    (mouseenter)="loadVisualization(dashboardConfig)"
                  ><!--TODO: filter kind-->
                    <nb-checkbox
                      [(checked)]="dashboardConfig.selected"
                    ></nb-checkbox
                    >{{ dashboardConfig.name }}
                  </nb-list-item>
                </nb-list>
              </nb-tab>
              <nb-tab tabTitle="Fahrzeugübersicht">
                <nb-list> </nb-list>
              </nb-tab>
            </nb-tabset>
          </nb-layout-column>
          <nb-layout-column>
            <ng-template visualizationHost></ng-template>
          </nb-layout-column>
        </nb-layout>
      </nb-card-body>
      <nb-card-footer style="display: flex; justify-content: end; gap: 15px">
        <button nbButton status="secondary" (click)="previous()">Zurück</button>
        <button nbButton status="primary" (click)="createSystem()">Erstellen</button>
      </nb-card-footer>
    </nb-card>
  </nb-step>
  <nb-step label="Fertig">
    <nb-card>
      <nb-card-header>
        <h2>System ist bereit</h2>
        <span class="caption-2"
          >Tragen Sie die folgenden Daten in den Markeplace ein, sodass Daten
          ihrer Subscription empfangen werden können</span
        >
      </nb-card-header>
      <nb-card-body>
        <nb-layout class="transparent fullheight">
          <nb-layout-column
            style="display: flex; justify-content: center; align-items: center"
          >
            <div
              style="
                gap: 30px;
                display: flex;
                flex-direction: column;
                width: 50%;
              "
            >
              <ng-template #copiedRef>
                <div style="padding: 15px">
                  <span>Kopiert!</span>
                </div>
              </ng-template>
              <div>
                <label for="webhook">Push-Url</label>
                <nb-form-field>
                  <input
                    id="webhook"
                    nbInput
                    fullWidth
                    readonly
                    [value]="'localhost:3001/webhook/'+newSystem?.id"
                  />
                  <button
                    nbSuffix
                    nbButton
                    ghost
                    (click)="copyToClipboard('localhost:3000/webhook/'+newSystem?.id)"
                    [nbPopover]="copiedRef"
                    nbPopoverPlacement="right"
                  ><!--TODO: actual values-->
                    <nb-icon [icon]="'clipboard-outline'" pack="eva"> </nb-icon>
                  </button>
                </nb-form-field>
              </div>

              <div>
                <label for="secret">Secret</label>
                <nb-form-field>
                  <input
                    id="secret"
                    nbInput
                    fullWidth
                    readonly
                    [value]="newSystem?.secret"
                  />
                  <button
                    nbSuffix
                    nbButton
                    ghost
                    (click)="copyToClipboard(newSystem?.secret)"
                    [nbPopover]="copiedRef"
                    nbPopoverPlacement="right"
                  >
                    <nb-icon [icon]="'clipboard-outline'" pack="eva"> </nb-icon>
                  </button>
                </nb-form-field>
              </div>
              <button nbButton status="primary" (click)="finish()" fullWidth>
                Zum System
              </button>
            </div>
          </nb-layout-column>
        </nb-layout>
      </nb-card-body>
    </nb-card>
  </nb-step>
</nb-stepper>
